$(document).ready(function() {
					$('#stats').fadeOut("slow");
					$('#stats').fadeIn("slow");
					$body = $("body");
					$(document).on({
					    ajaxStart: function() { $body.addClass("loading"); },
					    ajaxStop: function() { $body.removeClass("loading"); }
					});
	$("#appendedInputButton").keypress(function(event){ 
    if(event.keyCode == 13){ 
    event.preventDefault();
    $(".awesomplete").addClass("visually-hidden");
    $("#singleButton").click(); 
 	}
	});
	$("#singleButton").on("click", function() {
		$("#box").hide();
		var input = $("#appendedInputButton").val();		
		while (input.indexOf("rs") != 0) {
			alert("You did not enter a valid rs ID.");
			return;
			}
		//var root = 'http://localhost:3000';
		var root = 'http://sniphunter.sanbi.ac.za';
		$.ajax({
	  	url: root + '/PMCOAI_rs_articles?rs_number=' + input,
	 	method: 'GET',
		}).then(function(data) {
		var listz = [];
		for(var i=0; i < data.length; i++) {

			var elem = document.createElement("a");
			
			    rsID = data[i].rs_number;
			
				cited = data[i].rs_number_cited_in_article;

				pub = data[i].pubmed_id;
				if (pub ==	"not available") {		
				pub = "N/A";
				};

				year = data[i].publication_date;
				if (year ==	"not available") {		
				year = "N/A";
				};

				doi = data[i].doi;
				if (doi ==	"not available") {		
				doi = "N/A";
				};

				email = data[i].email_address;
				if (email == "not available") {		
				email = "N/A";
				};


				title = data[i].article_title;
				if (title == "not available") {		
				title = "<Please click for title>";
				};

			var textnode1 = document.createTextNode("SNP identifier " + rsID + " was mentioned at least " 
				+ cited + " time(s) in an article entitled ");
			var titlenode = document.createTextNode(title);
			var textnode2 = document.createTextNode(" published in " + year + 
				". The article has been tagged with Digital Object Identifier (DOI) " +  doi + 
				" and Pubmed Central ID " + pub +
				". For more information contact the correspondence author at " + email +
				" or click here to view the full paper");
			
			elem.appendChild(textnode1);
			elem.title = "Read the full paper";
			elem.href = "http://www.ncbi.nlm.nih.gov/pmc/?term=" + pub;
			elem.target = "_blank"
			elem.id = "updated";

			var span = document.createElement('span');
			span.style.color = "khaki";
			span.style.fontStyle = "italic";
			span.appendChild(titlenode);
			elem.appendChild(span);
			elem.appendChild(textnode2);

			listz.push([cited, elem]);
			listz.sort(function(a, b){return a[0]-b[0]});		

			};
			if (listz.length == 0) {
				var elem = document.createElement("h4");
				var noresults = document.createTextNode("\"" + input + "\"" + " did not match anything in the database"); 
				elem.appendChild(noresults);
				$("rs").append(elem);
			    };

			while (listz.length != 0) {
			readyToGo = listz.pop();
			readyToGo = readyToGo.concat();
			$("rs").append(readyToGo[1]);
			$("[id=updated]").addClass("btn btn-default updateSpecs");
			
			};
			});
			
		

	});
			$("#clearButton").on("click", function() {
				$("#divz").children().empty();
				$("#box").show();
			});
});	


